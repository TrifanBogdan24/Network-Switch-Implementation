```
Initialize:
    # Punem pe block-ing port-urile trunk pentru ca
    # doar de acolo pot aparea bucle. Port-urile catre
    # statii sunt pe deschise (e.g. designated)
    for each trunk port on the switch:
        Set port state to BLOCKING
 
    # In mod normal bridge ID este format si din switch.mac_address
    # pentru simplitate vom folosi doar priority value ce se gaseste in
    # configuratie
    own_bridge_ID =  switch.priority_value
    root_bridge_ID = own_bridge_ID
    root_path_cost = 0
 
    # daca portul devine root bridge setam porturile ca designated
    if own_bridge_ID == root_bridge_ID:
        For each port on the bridge:
            Set port state to DESIGNATED_PORT
```


```
Every 1 second:
    if switch is root:
        Send BPDU on all trunk ports with:
            root_bridge_ID = own_bridge_ID
            sender_bridge_ID = own_bridge_ID
            sender_path_cost = 0
```



```
On receiving a BPDU:
    if BPDU.root_bridge_ID < root_bridge_ID:
        root_bridge_ID = BPDU.root_bridge_ID
        # Vom adauga 10 la cost pentru ca toate link-urile sunt de 100 Mbps
        root_path_cost = BPDU.sender_path_cost + 10 
        root_port = port where BPDU was received
 
        if we were the Root Bridge:
            set all interfaces not to hosts to blocking except the root port  
 
 
        if root_port state is BLOCKING:
            Set root_port state to LISTENING
 
        Update and forward this BPDU to all other trunk ports with:
            sender_bridge_ID = own_bridge_ID
            sender_path_cost = root_path_cost
 
     Else if BPDU.root_bridge_ID == root_bridge_ID:
        If port == root_port and BPDU.sender_path_cost + 10 < root_path_cost:
            root_path_cost = BPDU.sender_path_cost + 10
 
        Else If port != Root_Port:
            # Verifica daca portul ar trebui trecut pe designated.
            # Designated inseamna ca drumul catre root este prin
            # acest switch. Daca am bloca acest drum, celelalte
            # switch-uri nu ar mai putea comunica cu root bridge.
            # Nota: in mod normal ar trebui sa stocam ultimul BPDU
            # de pe fiecare port ca sa calculam designated port.
            if BPDU.sender_path_cost > root_path_cost:
                If port is not the Designated Port for this segment:
                    Set port as the Designated Port and set state to LISTENING
 
    Else if BPDU.sender_bridge_ID == own_bridge_ID:
        Set port state to BLOCKING
    Else:
        Discard BPDU
 
    if own_bridge_ID == root_bridge_ID:
        For each port on the bridge:
            Set port as DESIGNATED_PORT

```